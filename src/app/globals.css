@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Brutalist color palette - Light Mode */
    --background: 0 0% 96%; /* Concrete white */
    --foreground: 0 0% 0%; /* Concrete black */

    --card: 0 0% 100%;
    --card-foreground: 0 0% 0%;

    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 0%;

    /* Primary: Danger Red */
    --primary: 349 78% 45%;
    --primary-foreground: 0 0% 100%;

    --secondary: 0 0% 50%; /* Concrete gray */
    --secondary-foreground: 0 0% 0%;

    --muted: 0 0% 96%;
    --muted-foreground: 0 0% 50%;

    /* Accent: Safety Orange */
    --accent: 23 100% 50%;
    --accent-foreground: 0 0% 100%;

    /* Success: Safety Orange */
    --success: 23 100% 50%;
    --success-foreground: 0 0% 100%;

    --destructive: 349 78% 45%;
    --destructive-foreground: 0 0% 100%;

    --border: 0 0% 0%; /* Black borders */
    --input: 0 0% 0%;
    --ring: 349 78% 45%; /* Red focus rings */

    --radius: 0.125rem; /* 2px sharp corners */

    --chart-1: 349 78% 45%;
    --chart-2: 0 0% 50%;
    --chart-3: 23 100% 50%;
    --chart-4: 0 0% 0%;
    --chart-5: 210 10% 85%;

    /* Focus ring system */
    --ring-width: 3px;
    --ring-width-subtle: 1px;
  }

  .dark {
    /* Brutalist color palette - Dark Mode */
    --background: 0 0% 0%; /* Concrete black */
    --foreground: 0 0% 96%; /* Concrete white */

    --card: 0 0% 5%;
    --card-foreground: 0 0% 96%;

    --popover: 0 0% 5%;
    --popover-foreground: 0 0% 96%;

    /* Primary: Brighter red for dark mode */
    --primary: 349 78% 50%;
    --primary-foreground: 0 0% 0%;

    --secondary: 0 0% 50%;
    --secondary-foreground: 0 0% 96%;

    --muted: 0 0% 10%;
    --muted-foreground: 0 0% 50%;

    /* Accent: Safety Orange (same in dark) */
    --accent: 23 100% 50%;
    --accent-foreground: 0 0% 0%;

    --success: 23 100% 50%;
    --success-foreground: 0 0% 0%;

    --destructive: 349 78% 50%;
    --destructive-foreground: 0 0% 96%;

    --border: 0 0% 96%; /* White borders in dark mode */
    --input: 0 0% 96%;
    --ring: 349 78% 50%;

    --chart-1: 349 78% 50%;
    --chart-2: 0 0% 60%;
    --chart-3: 23 100% 50%;
    --chart-4: 0 0% 96%;
    --chart-5: 210 10% 85%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground font-sans;
    /* Add subtle concrete texture */
    background-image: radial-gradient(
        circle at 20% 50%,
        rgba(128, 128, 128, 0.03) 0%,
        transparent 50%
      ),
      radial-gradient(
        circle at 80% 80%,
        rgba(128, 128, 128, 0.03) 0%,
        transparent 50%
      );
  }

  /* Monospace numbers everywhere */
  input[type="number"],
  .tabular-nums {
    @apply font-mono;
    font-variant-numeric: tabular-nums;
  }

  /* Thicker focus rings for number inputs (critical for workout logging) */
  input[type="number"]:focus-visible {
    --ring-width: 4px;
  }

  /* Context-aware focus system with golden ratio timing */
  *:focus-visible {
    @apply outline-none ring-danger-red ring-offset-2 ring-offset-background;
    --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(var(--ring-width) + var(--tw-ring-offset-width)) var(--tw-ring-color);
    box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow, 0 0 #0000);
    transition: box-shadow 0.146s cubic-bezier(0.4, 0, 0.2, 1); /* PRECISION_TIMING.MICRO */
    position: relative;
    z-index: 10; /* Ensure focus rings are always visible above adjacent elements */
  }

  /* Subtle focus for nested/inline contexts (dropdowns, modals) */
  .focus-subtle:focus-visible,
  .focus-subtle *:focus-visible {
    --ring-width: var(--ring-width-subtle);
  }

  /* Border-only focus (no ring) */
  .focus-border-only:focus-visible {
    --tw-ring-shadow: none;
    box-shadow: var(--tw-shadow, 0 0 #0000);
    @apply border-danger-red;
    transition: border-color 0.146s cubic-bezier(0.4, 0, 0.2, 1); /* PRECISION_TIMING.MICRO */
  }
}

/* iOS safe area insets - for notch and home indicator */
@layer utilities {
  .pb-safe {
    padding-bottom: env(safe-area-inset-bottom);
  }

  .pt-safe {
    padding-top: env(safe-area-inset-top);
  }

  .pl-safe {
    padding-left: env(safe-area-inset-left);
  }

  .pr-safe {
    padding-right: env(safe-area-inset-right);
  }

  /* Brutalist utilities */
  /* Concrete texture overlay */
  .concrete-texture {
    position: relative;
  }

  .concrete-texture::before {
    content: "";
    position: absolute;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' /%3E%3C/filter%3E%3Crect width='100' height='100' filter='url(%23noise)' opacity='0.05' /%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 1;
  }

  .concrete-texture > * {
    position: relative;
    z-index: 2;
  }

  /* Industrial button press */
  .btn-press {
    @apply active:scale-[0.97] active:shadow-inner transition-transform duration-75;
  }

  /* Mechanical animation preset */
  .mechanical-enter {
    animation: mechanical-slide 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
}
